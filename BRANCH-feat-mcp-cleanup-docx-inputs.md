# 分支说明：feat/mcp-cleanup-docx-inputs

## 背景
为 UI 增加“一键清理当前课程输出”能力，并在生成 Word 文档时显式传入最新生成的输入文件（教学大纲、教案 JSON、标记值），避免误用旧文件，提高可靠性与可控性。

## 主要改动
- 后端（Flask）：`UI/app.py`
  - 在 `index` 路由的 POST 流程中新增 `do=cleanup` 分支，可一键清理当前课程相关输出：
    - 删除 `output/` 与 `docs/` 目录下与课程名匹配的产物（教学大纲 Markdown、教案 JSON、标记值 Markdown、生成的 Word 文档）。
  - 调用 `mcp_wrapper.exe` 生成 Word 文档时，显式传入当次生成的三类输入文件路径（教学大纲、标记值、数据 JSON），避免读取历史文件。
- 前端（HTML）：`UI/templates/index.html`
  - 在主表单中增加“清理当前课程输出”按钮，使用 `formnovalidate`，无需填写 API Key、周数等即可执行清理。

## 使用说明
1. 启动 UI 后，选择或填写课程名称等信息。
2. 点击“清理当前课程输出”按钮即可删除当前课程相关输出（不会影响其他课程产物）。
3. 点击“生成文档”将按当前输入进行内容生成，并将新产物用于后续 Word 生成流程。

## 影响的文件/目录
- `UI/app.py`：后端路由逻辑、清理实现与生成流程。
- `UI/templates/index.html`：前端按钮与表单结构。
- `output/`：生成的中间产物（如 JSON/Markdown）。
- `docs/`：最终生成的 Word 文档。

## 验证步骤
1. 在 UI 中填入课程名称（例如：`软件测试`），点击“生成文档”，确认 `output/` 下生成对应 Markdown/JSON，`docs/` 下生成对应 `.docx`。
2. 再次点击“清理当前课程输出”，确认上述与该课程相关的文件被删除。
3. 再次点击“生成文档”，确认会重新生成并可下载。

## 注意事项
- 清理仅根据课程名进行匹配删除，请确保课程名准确无误。若课程名更改，请先清理旧名再生成新名。
- 生成 Word 文档依赖 `mcp_wrapper.exe`，需确保其可执行且路径正确。
- 若使用打包版本（`uipack` 目录/压缩包），请确保包含新版 `teach_ui.exe` 与相关依赖。

## 后续计划
- 清理范围可视化（列表预览+勾选删除）。
- 生成日志与下载历史记录。
- 更细粒度的异常提示与失败自诊断。

## 分支策略
- 暂不合并到 `main`，在该分支持续开发与验证。
- 创建 PR 前请确保：
  - 与 `main` 同步并解决冲突；
  - 基本用例验证通过；
  - 在 PR 描述中附上功能说明、验证步骤与影响范围。